<div class="product-list-admin">
  <!-- Cabe√ßalho -->
  <div class="admin-header">
    <div class="header-content">
      <h1 class="page-title">Gerenciar Produtos</h1>
      <p class="page-subtitle">Gerencie seu cat√°logo de produtos</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-primary" routerLink="/admin/products/new">
        <span class="btn-icon">‚ûï</span>
        Novo Produto
      </button>

      <!-- üß™ Bot√µes de Desenvolvimento (remover em produ√ß√£o) -->
      <div class="dev-actions" *ngIf="false">
        <button class="btn btn-outline" (click)="addMockProduct()" title="Adicionar produto mock">
          üß™ Add Mock
        </button>
        <button class="btn btn-outline" (click)="resetToMockProducts()" title="Resetar produtos">
          üîÑ Reset
        </button>
      </div>
    </div>
  </div>

  <!-- Barra de Ferramentas -->
  <div class="toolbar">
    <div class="search-box">
      <div class="search-input-wrapper">
        <span class="search-icon">üîç</span>
        <input type="text" [value]="searchInput()" (input)="onSearchInput($any($event.target).value)"
          (keyup.enter)="applyFilters()" placeholder="Buscar por nome, descri√ß√£o ou categoria..." class="search-input">
        <button *ngIf="searchInput()" class="clear-search" (click)="clearSearch()" type="button"
          aria-label="Limpar busca">
          ‚úï
        </button>
      </div>
    </div>

    <div class="toolbar-controls">
      <button class="btn btn-outline" (click)="showFilters.set(!showFilters())" [class.active]="showFilters()"
        title="Mostrar/ocultar filtros">
        <span class="btn-icon">üéõÔ∏è</span>
        Filtros
        <span class="badge" *ngIf="showFilters()">{{ categories().length }}</span>
      </button>

      <button class="btn btn-outline" (click)="refreshProducts()" [disabled]="isLoading()" title="Recarregar produtos">
        <span class="btn-icon">üîÑ</span>
        Atualizar
      </button>
    </div>
  </div>

  <!-- Filtros Avan√ßados -->
  <div class="filters-panel" *ngIf="showFilters()">
    <app-product-filters [filters]="filters()" [categories]="categories()" (filtersChange)="onFiltersChange($event)"
      (clear)="clearFilters()">
    </app-product-filters>
  </div>

  <!-- A√ß√µes em Lote -->
  <div class="bulk-actions-panel" *ngIf="selectedProducts().length > 0">
    <app-product-bulk-actions [selectedCount]="selectedCount()" [isLoading]="isBulkActionLoading()"
      (action)="executeBulkAction($event)" (clear)="clearSelection()">
    </app-product-bulk-actions>
  </div>

  <!-- Conte√∫do Principal -->
  <div class="content-area">
    <!-- Loading State -->
    <div class="loading-state" *ngIf="isLoading()">
      <div class="loading-spinner"></div>
      <p>Carregando produtos...</p>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="!isLoading() && products().length === 0">
      <div class="empty-icon">üì¶</div>
      <h3>Nenhum produto encontrado</h3>
      <p>N√£o encontramos produtos com os filtros atuais.</p>
      <div class="empty-actions">
        <button class="btn btn-primary" (click)="clearFilters()">
          Limpar Filtros
        </button>
        <button class="btn btn-outline" routerLink="/admin/products/new">
          Criar Primeiro Produto
        </button>
      </div>
    </div>

    <!-- Lista de Produtos -->
    <div class="products-container" *ngIf="!isLoading() && products().length > 0">

      <!-- Cabe√ßalho da Tabela -->
      <div class="table-header">
        <div class="table-row header-row">
          <div class="table-cell select-cell">
            <label class="checkbox-wrapper">
              <input type="checkbox" [checked]="isAllSelected()" (change)="toggleSelectAll()"
                [indeterminate]="isSomeSelected()"
                [attr.aria-label]="isAllSelected() ? 'Desmarcar todos' : 'Marcar todos'">
              <span class="checkmark"></span>
            </label>
          </div>
          <div class="table-cell product-cell">Produto</div>
          <div class="table-cell category-cell">Categoria</div>
          <div class="table-cell price-cell">Pre√ßo</div>
          <div class="table-cell stock-cell">Estoque</div>
          <div class="table-cell status-cell">Status</div>
          <div class="table-cell actions-cell">A√ß√µes</div>
        </div>
      </div>

      <!-- Lista de Produtos -->
      <div class="table-body">
        <div *ngFor="let product of products()" class="table-row product-row"
          [class.selected]="selectedProducts().includes(product.id)" [class.low-stock]="hasLowStock(product)"
          [class.out-of-stock]="isOutOfStock(product)">

          <!-- Sele√ß√£o -->
          <div class="table-cell select-cell">
            <label class="checkbox-wrapper">
              <input type="checkbox" [checked]="selectedProducts().includes(product.id)"
                (change)="toggleProductSelection(product.id)" [attr.aria-label]="'Selecionar ' + product.name">
              <span class="checkmark"></span>
            </label>
          </div>

          <!-- Informa√ß√µes do Produto -->
          <div class="table-cell product-cell">
            <app-product-card-admin [product]="product" [selected]="selectedProducts().includes(product.id)"
              (view)="viewProduct(product.id)" (edit)="editProduct(product.id)">
            </app-product-card-admin>
          </div>

          <!-- Categoria -->
          <div class="table-cell category-cell">
            <span class="category-badge" [title]="product.category.description">
              {{ getCategoryName(product) }}
            </span>
          </div>

          <!-- Pre√ßo -->
          <div class="table-cell price-cell">
            <div class="price-display">
              <span class="current-price">{{ formatPrice(product.price) }}</span>
            </div>
          </div>

          <!-- Estoque -->
          <div class="table-cell stock-cell">
            <div class="stock-display">
              <span class="stock-quantity" [class.low-stock]="hasLowStock(product)"
                [class.out-of-stock]="isOutOfStock(product)">
                {{ product.stockQuantity }}
              </span>
              <span class="stock-label">unidades</span>
            </div>
          </div>

          <!-- Status -->
          <div class="table-cell status-cell">
            <span class="status-badge" [class]="getStockStatus(product).class">
              {{ getStockStatus(product).text }}
            </span>
          </div>

          <!-- A√ß√µes -->
          <div class="table-cell actions-cell">
            <div class="action-buttons">
              <button class="btn btn-text btn-primary" (click)="editProduct(product.id)" title="Editar produto"
                [disabled]="isBulkActionLoading()">
                <span class="btn-icon">‚úèÔ∏è</span>
              </button>

              <button class="btn btn-text btn-secondary" (click)="viewProduct(product.id)" title="Visualizar produto"
                [disabled]="isBulkActionLoading()">
                <span class="btn-icon">üëÅÔ∏è</span>
              </button>

              <button class="btn btn-text btn-danger" (click)="deleteProduct(product)" title="Excluir produto"
                [disabled]="isBulkActionLoading()">
                <span class="btn-icon">üóëÔ∏è</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Pagina√ß√£o -->
    <div class="pagination-wrapper" *ngIf="!isLoading() && products().length > 0">

      <!-- Seletor de Itens por P√°gina -->
      <div class="page-size-selector">
        <label for="pageSize">Itens por p√°gina:</label>
        <select id="pageSize" [value]="pagination().pageSize" (change)="changePageSize($any($event.target).value)">
          <option value="10">10</option>
          <option value="25">25</option>
          <option value="50">50</option>
          <option value="100">100</option>
        </select>
      </div>

      <!-- Componente de Pagina√ß√£o -->
      <app-pagination [currentPage]="pagination().currentPage" [totalPages]="pagination().totalPages"
        [totalItems]="pagination().totalItems" [itemsPerPage]="pagination().pageSize"
        (pageChange)="onPageChange($event)">
      </app-pagination>

      <!-- Informa√ß√£o de Sele√ß√£o -->
      <div class="selection-info" *ngIf="selectedCount() > 0">
        <span>{{ selectedCount() }} produto(s) selecionado(s)</span>
      </div>
    </div>
  </div>
</div>